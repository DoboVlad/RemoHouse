<div id="body" xmlns="http://www.w3.org/1999/html">
  <mat-toolbar color="primary">
    <div>
      <button mat-icon-button (click)="sidenav.toggle()">
        <mat-icon>menu</mat-icon>
      </button>
    </div>

    <span class="title">Welcome, {{user.name}}</span>
    <span class="example-spacer"></span>

  </mat-toolbar>
  <mat-sidenav-container class="example-container">

    <mat-sidenav  #sidenav  mode="over"  opened="false" >
      <div>
        <a mat-button (click)="setProfile()">Profile</a>
        <a mat-button (click)="setManageLocations()">Manage locations</a>
        <a mat-button (click)="setManageRooms()">Manage rooms</a>
        <a mat-button (click)="setManageController()">Manage controllers</a>
        <a mat-button (click)="setSecurity()">Security</a>
        <a mat-button class="bottom" (click)="logOut()">Logout</a>
      </div>
    </mat-sidenav>
    <mat-sidenav-content >
      <!--ngIf for each section -->
      <div class="profile" *ngIf="isProfile()">
        <h1>Profile</h1>
        <table class="data" cellspacing="0">
          <tr><td class="left">Name:</td><td class="right">{{user.name}}</td> </tr>

          <tr><td class="left">Surname:</td><td class="right">{{user.surname}}</td> </tr>

          <tr><td class="left">Email:</td><td class="right">{{user.email}}</td> </tr>

          <tr><td class="left">Phone number:</td><td class="right">{{user.phoneNumber}}</td> </tr>
        </table>
      </div>
      <div class="security" *ngIf="isSecurity()">
        <!-- divided into 2 sections: password and sessios-->
        <div class="password">
        <h1>Change password</h1>
          <p class="label">Old password:</p>
          <p class="input"><input #oldPassword type="password"></p>
          <p class="label">New password:</p>
          <p class="input"><input #newPassword type="password"></p>
          <p class="label">Confirm password:</p>
          <p class="input"><input #confirmPassword type="password"></p>
        <a mat-button (click)="changePassword2(oldPassword.value,newPassword.value,confirmPassword.value)">Confirm</a>
        <br>
        </div>
        <div class="sessions">
        <h1>Sessions</h1>
        <h2>ip-location-date-time</h2>
      </div>
      </div>

      <div class="manageLocations" *ngIf="isManageLocations()">
        <mat-form-field class="location-form-field">
          <mat-label>Filter locations</mat-label>
          <label>
            <input matInput (keyup)="applyFilter($event, locationDataSource)" placeholder="Ex. home" class="filter-locations">
          </label>
        </mat-form-field>
        <table mat-table
               [dataSource]="locationDataSource" multiTemplateDataRows
               class="mat-elevation-z8">
          <ng-container matColumnDef="{{column}}" *ngFor="let column of locationColumns">
            <th mat-header-cell *matHeaderCellDef> {{column}} </th>
            <td mat-cell *matCellDef="let location"> {{location[column]}} </td>
          </ng-container>

          <ng-container matColumnDef="expandedDetail">
            <td mat-cell *matCellDef="let location" [attr.colspan]="locationColumns.length">
              <div class="location-detail"
                   [@detailExpand]="location == expandedLocation ? 'expanded' : 'collapsed'">
                <div class="room-table-wrapper">
                  <mat-form-field class="room-form-field">
                    <mat-label class="room-filter-label">Filter rooms</mat-label>
                    <label>
                      <input matInput (keyup)="applyFilter($event, roomDataSource)" placeholder="Ex. kitchen" class="filter-rooms">
                    </label>
                  </mat-form-field>
                  <table mat-table
                         [dataSource]="roomDataSource" multiTemplateDataRows
                         class="room-table">
                    <ng-container matColumnDef="{{column}}" *ngFor="let column of roomColumns">
                      <th mat-header-cell *matHeaderCellDef> {{column}} </th>
                      <td mat-cell *matCellDef="let room"> {{room[column]}} </td>
                    </ng-container>

                    <ng-container matColumnDef="Update">
                      <th mat-header-cell *matHeaderCellDef></th>
                      <td mat-cell *matCellDef="let room">

                        <!-- This is where we have to add the function to update the room -->
                        <button mat-button color="basic" aria-label="Update room" matTooltip="Update room">
                          <mat-icon>create</mat-icon>
                        </button>

                      </td>
                    </ng-container>

                    <ng-container matColumnDef="Delete">
                      <th mat-header-cell *matHeaderCellDef></th>
                      <td mat-cell *matCellDef="let room">

                        <!-- This is where we have to add the function to delete the room -->
                        <button mat-button color="warn" aria-label="Delete room" matTooltip="Delete room">
                          <mat-icon>delete</mat-icon>
                        </button>

                      </td>
                    </ng-container>

                    <ng-container matColumnDef="expandedRoom">
                      <td mat-cell *matCellDef="let room" [attr.colspan]="roomColumns.concat(['Update', 'Delete']).length">
                        <div class="location-detail"
                             [@detailExpand]="room == expandedRoom ? 'expanded' : 'collapsed'">

                          <div class="controller-table-wrapper">
                            <mat-form-field class="room-form-field">
                              <mat-label class="room-filter-label">Filter controllers</mat-label>
                              <label>
                                <input matInput (keyup)="applyFilter($event, controllerDataSource)" placeholder="Ex. door" class="filter-rooms">
                              </label>
                            </mat-form-field>

                            <table mat-table
                                   [dataSource]="controllerDataSource" multiTemplateDataRows
                                   class="controller-table">
                              <ng-container matColumnDef="{{column}}" *ngFor="let column of controllerColumns">
                                <th mat-header-cell *matHeaderCellDef> {{column}} </th>
                                <td mat-cell *matCellDef="let controller"> {{controller[column]}} </td>
                              </ng-container>

                              <ng-container matColumnDef="Update">
                                <th mat-header-cell *matHeaderCellDef></th>
                                <td mat-cell *matCellDef="let controller">

                                  <!-- This is where we have to add the function to update the controller -->
                                  <button mat-button color="basic" aria-label="Update controller" matTooltip="Update controller">
                                    <mat-icon>create</mat-icon>
                                  </button>
                                </td>
                              </ng-container>

                              <ng-container matColumnDef="Delete">
                                <th mat-header-cell *matHeaderCellDef></th>
                                <td mat-cell *matCellDef="let controller">

                                  <!-- This is where we have to add the function to delete the controller -->
                                  <button mat-button color="warn" aria-label="Delete controller" matTooltip="Delete controller">
                                    <mat-icon>delete</mat-icon>
                                  </button>
                                </td>
                              </ng-container>

                              <tr mat-header-row *matHeaderRowDef="controllerColumns.concat(['Update', 'Delete'])"></tr>
                              <tr mat-row *matRowDef="let controller; columns: controllerColumns.concat(['Update', 'Delete'])"
                                  class="controller-row">
                              </tr>
                            </table>

                            <!-- This is where we have to add the function to create a new controller-->
                            <button mat-mini-fab class="addButton" color="basic" aria-label="Add controller" matTooltip="Add controller">
                              <mat-icon>add</mat-icon>
                            </button>

                          </div>
                        </div>
                      </td>
                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="roomColumns.concat(['Update', 'Delete'])"></tr>
                    <tr mat-row *matRowDef="let room; columns: roomColumns.concat(['Update', 'Delete']);"
                        class="room-row"
                        [class.example-expanded-row]="roomColumns.concat(['Update', 'Delete']) === room"
                        (click)="toggleRooms(room)">
                    </tr>
                    <tr mat-row *matRowDef="let row; columns: ['expandedRoom']" class="detail-row"></tr>
                  </table>

                  <!-- This is where we have to add the function to create a new room-->
                  <button mat-mini-fab class="addButton" color="basic" aria-label="Add room" matTooltip="Add room">
                    <mat-icon>add</mat-icon>
                  </button>

                </div>
                <div class="buttons">

                  <!-- This is where we have to add the function to delete the location -->
                  <button mat-fab color="warn" aria-label="Delete location" matTooltip="Delete location">
                    <mat-icon>delete</mat-icon>
                  </button>

                  <!-- This is where we have to add the function to update the location -->
                  <button mat-fab color="basic" aria-label="Update location" matTooltip="Update location">
                    <mat-icon>create</mat-icon>
                  </button>
                </div>
              </div>
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="locationColumns"></tr>
          <tr mat-row *matRowDef="let location; columns: locationColumns;"
              class="location-row"
              [class.example-expanded-row]="locationColumns === location"
              (click)="toggleLocationRow(location)">
          </tr>
          <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="detail-row"></tr>
        </table>

        <!--This is where we have to add the create functionality to the button-->
        <button mat-mini-fab class="addButton" color="basic" aria-label="Add location" matTooltip="Add location">
          <mat-icon>add</mat-icon>
        </button>
      </div>
    </mat-sidenav-content>
  </mat-sidenav-container>
</div>

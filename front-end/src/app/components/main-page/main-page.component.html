<head><meta name="pinterest" content="nopin" /></head>
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous">

<style>
  .loader {
    position: relative;
    display: flex;
    justify-content: center;
    justify-items: center;
    align-content: center;
    align-items: center;
    border: 16px solid #f3f3f3;
    border-radius: 50%;
    border-top: 16px solid #3498db;
    width: 70px;
    height: 70px;
    left:50%;
    top:50%;
    -webkit-animation: spin 2s linear infinite; /* Safari */
    animation: spin 2s linear infinite;
  }
  #overlay{
    position: absolute;
    top:0px;
    left:0px;
    width: 100%;
    height: 100%;
    background: transparent;
  }
  .container{
    position:relative;
  }

  /* Safari */
  @-webkit-keyframes spin {
    0% { -webkit-transform: rotate(0deg); }
    100% { -webkit-transform: rotate(360deg); }
  }

  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
</style>

<div id="wrapper1" *ngIf="locationsLoaded else loading">
  <mat-grid-list *ngIf="isUserLoggedIn()" class="wrapper" cols="5" rowHeight="fit">
  <mat-grid-tile colspan="4">
    <mat-grid-list class="left-side" cols="1" rowHeight="fit">
      <mat-grid-tile class="location" rowspan="2">
        <p class="room-name left" *ngIf="(locationsObservable | async) as locations">{{getLocationName()}}</p>
      </mat-grid-tile>
      <mat-grid-tile class="room">
        <p class="room-name" *ngIf="(roomsObservable | async) as rooms">{{getRoomName()}}</p>
      </mat-grid-tile>
      <mat-grid-tile class="image" rowspan="12">
        <div class="not_found" *ngIf="!hasRooms()">Sorry! There are no rooms here.</div>
        <div class="not_found" *ngIf="hasRooms() && !hasGSM()">Sorry! There are no GSMS here.</div>
        <img matListAvatar *ngIf="(imageLoaded | async)" [src]="getImage()" (error)="imageExists = false" [hidden]="!imageExists" alt="room-image" class="img-responsive">
      </mat-grid-tile>
    </mat-grid-list>
  </mat-grid-tile>
  <mat-grid-tile>
    <mat-grid-list class="right-side" cols="1" rowHeight="fit">
      <mat-grid-tile></mat-grid-tile>
      <mat-grid-tile class="date">
        <p class="date-time">{{ CurrentDate | date:'MMM d, y HH:mm'}}</p>
      </mat-grid-tile>
      <mat-grid-tile class="pick-location" rowspan="8">
        <mat-accordion>
        <mat-expansion-panel hideToggle>
          <mat-expansion-panel-header>
            <mat-panel-title>
              Location
            </mat-panel-title>
            <mat-panel-description>
            </mat-panel-description>
          </mat-expansion-panel-header>
          <mat-selection-list #location class="locationList" [(ngModel)]="locationList" multiple="false" (selectionChange)="changeRoom(location.selectedOptions.selected)">
            <mat-list-option *ngFor="let location of locations" [value]="location.name">{{location.name}}</mat-list-option>
          </mat-selection-list>
        </mat-expansion-panel><!-- Rooms-->
          <h1 *ngIf="!hasRooms()" class="unexistent">There are no rooms</h1>
          <mat-expansion-panel *ngIf="hasRooms()" hideToggle>

          <mat-expansion-panel-header>
            <mat-panel-title>
              Rooms
            </mat-panel-title>
            <mat-panel-description>
            </mat-panel-description>
          </mat-expansion-panel-header>
            <mat-selection-list  #room class="roomList" [(ngModel)]="roomList" multiple="false" (selectionChange)="changeControllers(room.selectedOptions.selected)">
              <mat-list-option *ngFor="let room of rooms" [value]="room.name">{{room.name}}</mat-list-option>
            </mat-selection-list>
          <mat-list></mat-list>
        </mat-expansion-panel>
          <!-- Controllers-->
          <h1 *ngIf="hasRooms() && !hasGSM()" class="unexistent">There are no gsms</h1>
          <mat-expansion-panel *ngIf="hasGSM()" hideToggle>
          <mat-expansion-panel-header>
            <mat-panel-title>
              Controllers
            </mat-panel-title>
            <mat-panel-description>
            </mat-panel-description>
          </mat-expansion-panel-header>
          <mat-list class="left" *ngIf="controllersObservable | async">
            <app-controller-toggle (notify)="controllerToggled($event)" [controller]="gsm" *ngFor="let gsm of gsms"></app-controller-toggle>
          </mat-list>
        </mat-expansion-panel>
        </mat-accordion>
      </mat-grid-tile>
      <mat-grid-tile *ngIf="this.currentLocation"
                     class="weather" rowspan="5">
        <div id="weather">
          <div *ngIf="WeatherData.isDay" class="weatherWidgetRow">
            <i class="fas fa-3x fa-sun sun"></i>
          </div>
          <div *ngIf="!WeatherData.isDay" class="weatherWidgetRow">
            <i class="fas fa-3x fa-moon moon"></i>
          </div>
          <div class="weatherWidgetRow cloudDiv">
            <i class="fas fa-cloud fa-3x cloud"></i>
          </div>
          <div class="weatherWidgetRow" style="font-size: 2em; margin-top: 0.5em;">{{WeatherData.temp_celsius}}째</div>
          <div class="weatherWidgetRow" style="font-size: 1.2em; margin-top: 0.5em">{{WeatherData.temp_min}}째 / {{WeatherData.temp_max}}째</div>
          <div class="weatherWidgetRow" style="font-size: 1.2em;">Feels Like: {{WeatherData.temp_feels_like}}째</div>
          <div class="weatherWidgetRow" style="font-size: 2em;margin-top: 0.5em;">{{WeatherData.name}}</div>
          <div class="weatherWidgetRow" style="font-size: 1.2em; margin-top:1em">Humidity: {{WeatherData.main.humidity}}%</div>
          </div>
      </mat-grid-tile>
    </mat-grid-list>
  </mat-grid-tile>
</mat-grid-list>
</div>

<ng-template class="container" #loading>
  <div id="overlay">
    <div class="loader"></div>
  </div>
</ng-template>
